<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>Teleprompter by MCSquad</title>
  <style>
    :root{
      --bg1:#0f0f15;
      --bg2:#141b2d;
      --accent:#00e0ff;
      --accent2:#9d4edd;
      --danger:#ff3b3b;
      --ok:#00d38f;
      --text:#e6eef8;
      --muted:#9aa3ad;
      --card:#0b0f1aee;
      --border: rgba(255,255,255,0.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji','Segoe UI Emoji', 'Segoe UI Symbol';
      color:var(--text);
      background: radial-gradient(1200px 600px at 10% 10%, rgba(0,224,255,.08), transparent 60%),
                  radial-gradient(1000px 700px at 90% 30%, rgba(157,78,221,.10), transparent 60%),
                  linear-gradient(160deg,var(--bg1),var(--bg2));
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }
    header{
      position:sticky; top:0; z-index:10;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:12px;
      padding:20px 64px;
      border-bottom:1px solid var(--border);
      background: linear-gradient( to bottom, rgba(10,12,20,.9), rgba(10,12,20,.65));
      backdrop-filter: blur(8px);
    }
    #brand{ display:flex; align-items:center; gap:12px; }
    #brand a{ display:inline-flex; }
    #brand img{ height:72px; width:auto; object-fit:contain; filter: drop-shadow(0 0 8px rgba(0,224,255,.35)); }

    #title{
      justify-self:center;
      font-weight:800; letter-spacing:.3px;
      font-size: clamp(28px, 4vw, 56px);
      text-align:center;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      -webkit-background-clip:text; background-clip:text;
      color:transparent;
      text-shadow: 0 0 18px rgba(0,224,255,.35);
    }
    #actions{justify-self:end; display:flex; gap:8px; align-items:center;}
    #actions a img{ height:44px; width:auto; }
    #actions a img:hover{ filter: drop-shadow(0 0 6px rgba(88,101,242,.7)); }

    main{ display:flex; flex:1; min-height:0; }

    /* Panel lateral (redimensionable con splitter) */
    #editor{
      flex: 0 0 auto;          /* width gobierna */
      width: 30%;              /* por defecto */
      min-width: 200px;        /* m√≠nimo absoluto */
      max-width: 40%;          /* m√°ximo relativo */
      padding:14px;
      border-right:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.00));
      display:flex; flex-direction:column; gap:14px;
      overflow:auto;
    }

    /* Separador draggable */
    #splitter{
      width:10px; flex: 0 0 10px; cursor: col-resize;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-right:1px solid var(--border);
      position:relative;
      user-select:none; touch-action:none;
    }
    #splitter::after{
      content:""; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
      width:3px; height:36px; border-radius:2px; background: rgba(255,255,255,.22);
    }

    #inputText{
      flex:1; min-height:160px; max-height:45vh;
      width:100%; padding:14px 12px;
      background: var(--card);
      border:1px solid var(--border);
      border-radius:12px; color:#c8f7c5;
      font-size:16px; line-height:1.5; resize: vertical;   /* solo vertical */
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
    }

    /* Contenedor de controles ocupa todo el ancho del editor */
    #controlBar{ display:block; width:100%; }
    .card{ background: var(--card); border:1px solid var(--border); border-radius:14px; padding:14px; width:100%; }
    .control{ display:flex; align-items:center; gap:10px; justify-content:space-between; padding:8px 10px; flex-wrap:wrap; }
    input[type=range]{ width: 100%; }
    label{ font-size:13px; color:#9aa3ad; }

    /* Fila de botones con scroll horizontal en pantallas estrechas */
    #controlsRow{ /* 2 filas + scroll horizontal */
      display:grid !important;
      grid-auto-flow: column;
      grid-auto-columns: max-content;
      grid-template-rows: repeat(2, auto);
      gap:8px 12px;
      overflow-x:auto; overflow-y:hidden;
      -webkit-overflow-scrolling: touch;
      padding-bottom:6px;
      scrollbar-width:thin; /* mostrar barra en Firefox */
      justify-content: initial;
      align-items: stretch;
    }
    #controlsRow::-webkit-scrollbar{ height:8px; }
    #controlsRow::-webkit-scrollbar-thumb{ background: rgba(255,255,255,.35); border-radius:8px; }
    #controlsRow::-webkit-scrollbar-track{ background: rgba(255,255,255,.12); border-radius:8px; }

    /* Botones (compactos) */
    .btn{ padding:6px 12px; border:none; border-radius:8px; font-size:13px; font-weight:600; cursor:pointer; transition:all .2s ease; white-space:nowrap; }
    .btn-ok{background:linear-gradient(135deg,var(--ok),#00b37a);color:#fff;}
    .btn-danger{background:linear-gradient(135deg,var(--danger),#c93030);color:#fff;}
    .btn{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;}
    .btn:hover{opacity:.85; transform:translateY(-2px);}

    #viewer{ flex:1 1 auto; position:relative; overflow:hidden; display:flex; align-items:center; justify-content:center; padding:10px; }
    #viewerInner{ position:relative; width: min(100%, 1200px); height: 100%; border:1px solid var(--border); border-radius:16px; background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01)); backdrop-filter: blur(4px); box-shadow: inset 0 0 40px rgba(0,224,255,.06), 0 10px 30px rgba(0,0,0,.35); overflow:hidden; }
    #teleprompter{ position:absolute; left:50%; transform: translateX(-50%) scaleY(var(--mirror, 1)); width: 86%; max-width: 1000px; white-space: pre-wrap; text-align:center; font-size: clamp(24px, 4.2vw, 60px); line-height: 1.5; top: 100%; color: #f2f7ff; text-shadow: 0 0 10px rgba(0,224,255,.08); }
    #reference-line{ position:absolute; top:50%; left:0; right:0; height:2px; background: linear-gradient(90deg, transparent, var(--danger), transparent); opacity:.55; pointer-events:none; }
    .hidden{ display:none !important; }

    /* ===== Responsive m√≥vil ===== */
    @media (max-width: 980px){
      header{ padding:12px 16px; }
      #brand img{ height:48px; }
      #title{ font-size: clamp(20px, 6vw, 34px); }
      #actions a img{ height:32px; }

      main{ flex-direction: column; }
      #splitter{ display:none; }
      #editor{ width:100%; max-width:none; border-right:none; border-bottom:1px solid var(--border); gap:12px; }
      #inputText{ max-height: 38vh; }

      /* El card de controles se mantiene visible en la parte superior del editor */
      #controlBar .card{ position: sticky; top: 0; z-index: 5; }

      /* Botones m√°s c√≥modos al tacto */
      .btn{ padding:10px 14px; font-size:14px; }
      #controlsRow{ padding-bottom: 6px; }

      /* M√°s altura para el visor en m√≥vil */
      #viewerInner{ height: 70vh; }
    }

    @media (min-width: 981px){
      #viewerInner{ height: calc(100vh - 112px); }
    }
  </style>
</head>
<body>
  <header>
    <div id="brand">
      <a href="https://mcsquad.net/" title="Ir al inicio MCSquad">
        <img src="https://mcsquad.net/logomcsquad.png" alt="Logo MCSquad">
      </a>
    </div>
    <div id="title">Teleprompter by MCSquad</div>
    <div id="actions">
      <a href="https://discord.com/invite/8uvAN9CTH9" target="_blank" rel="noopener" title="√önete a Discord">
        <img src="https://cdn.worldvectorlogo.com/logos/discord-6.svg" alt="Discord">
      </a>
    </div>
  </header>

  <main>
    <section id="editor">
      <textarea id="inputText" placeholder="Escribe o pega aqu√≠ tu guion‚Ä¶&#10;Sugerencia: usa p√°rrafos breves y saltos de l√≠nea para respirar."></textarea>

      <div id="controlBar">
        <div class="card">
          <div class="control">
            <label for="speed">Velocidad</label>
            <input type="range" id="speed" min="0.1" max="2" value="0.6" step="0.05">
          </div>
          <div class="control">
            <label for="fontSize">Tama√±o de texto</label>
            <input type="range" id="fontSize" min="20" max="120" value="48" step="2">
          </div>
          <div class="control" id="controlsRow">
            <button class="btn btn-ok" id="playBtn">‚ñ∂ Iniciar</button>
            <button class="btn" id="pauseBtn">‚è∏ Pausar</button>
            <button class="btn btn-danger" id="resetBtn">‚èÆ Reiniciar</button>
            <button class="btn" id="fullscreenBtn">‚õ∂ Pantalla completa</button>
            <button class="btn" id="mirrorBtn">ü™û Espejo</button>
            <label class="btn pill" style="cursor:pointer;">
              <input type="checkbox" id="toggleLine" checked style="accent-color:var(--danger); width:16px; height:16px; margin-right:6px;"> L√≠nea gu√≠a
            </label>
          </div>
        </div>
      </div>
    </section>

    <div id="splitter" role="separator" aria-orientation="vertical" aria-label="Redimensionar panel"></div>

    <section id="viewer">
      <div id="viewerInner">
        <div id="teleprompter"></div>
        <div id="reference-line"></div>
      </div>
    </section>
  </main>

  <script>
    const inputText = document.getElementById("inputText");
    const teleprompter = document.getElementById("teleprompter");
    const speed = document.getElementById("speed");
    const fontSize = document.getElementById("fontSize");
    const refLine = document.getElementById("reference-line");
    const playBtn = document.getElementById("playBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const resetBtn = document.getElementById("resetBtn");
    const fullscreenBtn = document.getElementById("fullscreenBtn");
    const mirrorBtn = document.getElementById("mirrorBtn");
    const toggleLine = document.getElementById("toggleLine");
    const viewerInner = document.getElementById("viewerInner");
    const mainEl = document.querySelector('main');
    const editor = document.getElementById('editor');
    const splitter = document.getElementById('splitter');

    let rafId = null;
    let pos = 0;
    let running = false;

    function init(){
      updateTeleprompter();
      teleprompter.style.fontSize = fontSize.value + "px";
      refLine.classList.toggle("hidden", !toggleLine.checked);
      resetPosition();
    }

    function updateTeleprompter(){
      teleprompter.textContent = inputText.value || "Pega tu guion aqu√≠‚Ä¶\n\nConsejo: usa pausas con l√≠neas en blanco y ajusta la velocidad para tu ritmo de lectura.";
      resetPosition();
    }

    function resetPosition(){
      pos = viewerInner.clientHeight + 12;
      teleprompter.style.top = pos + "px";
    }

    function step(){
      pos -= parseFloat(speed.value);
      teleprompter.style.top = pos + "px";
      if(pos + teleprompter.scrollHeight > 0 && running){
        rafId = requestAnimationFrame(step);
      }else{
        running = false;
      }
    }

    playBtn.addEventListener("click", ()=>{
      if(running) return;
      running = true;
      cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(step);
    });
    pauseBtn.addEventListener("click", ()=>{ running = false; cancelAnimationFrame(rafId); });
    resetBtn.addEventListener("click", ()=>{
      running = false;
      cancelAnimationFrame(rafId);
      resetPosition();
      running = true;
      rafId = requestAnimationFrame(step);
    });
    inputText.addEventListener("input", updateTeleprompter);
    fontSize.addEventListener("input", ()=>{ teleprompter.style.fontSize = fontSize.value + "px"; });
    toggleLine.addEventListener("change", ()=>{ refLine.classList.toggle("hidden", !toggleLine.checked); });

    fullscreenBtn.addEventListener("click", ()=>{
      const el = document.documentElement;
      if(!document.fullscreenElement){ el.requestFullscreen?.(); } else { document.exitFullscreen?.(); }
    });

    mirrorBtn.addEventListener("click", ()=>{
      const mirrored = getComputedStyle(teleprompter).getPropertyValue("--mirror").trim();
      const v = (mirrored && mirrored !== "1") ? 1 : -1;
      teleprompter.style.setProperty("--mirror", v);
    });

    document.addEventListener("keydown", (e)=>{
      if(e.target === inputText) return;
      if(e.code === "Space"){ e.preventDefault(); running ? pauseBtn.click() : playBtn.click(); }
      if(e.key === "ArrowUp"){ e.preventDefault(); speed.value = Math.min(parseFloat(speed.max), parseFloat(speed.value)+0.1); }
      if(e.key === "ArrowDown"){ e.preventDefault(); speed.value = Math.max(parseFloat(speed.min), parseFloat(speed.value)-0.1); }
      if(e.key === "+"){ fontSize.value = Math.min(parseInt(fontSize.max), parseInt(fontSize.value)+2); fontSize.dispatchEvent(new Event("input")); }
      if(e.key === "-"){ fontSize.value = Math.max(parseInt(fontSize.min), parseInt(fontSize.value)-2); fontSize.dispatchEvent(new Event("input")); }
      if(e.key?.toLowerCase() === "f"){ fullscreenBtn.click(); }
      if(e.key?.toLowerCase() === "m"){ mirrorBtn.click(); }
      if(e.key?.toLowerCase() === "l"){ toggleLine.checked = !toggleLine.checked; toggleLine.dispatchEvent(new Event("change")); }
    });

    // --- Splitter (drag resize) ---
    let dragging = false, startX = 0, startW = 0, mainW = 0;

    splitter.addEventListener('pointerdown', (e)=>{
      dragging = true;
      startX = e.clientX;
      mainW = mainEl.getBoundingClientRect().width;
      startW = editor.getBoundingClientRect().width;
      splitter.setPointerCapture(e.pointerId);
      document.body.style.userSelect = 'none';
    });

    window.addEventListener('pointermove', (e)=>{
      if(!dragging) return;
      const dx = e.clientX - startX;
      let newPx = startW + dx;
      let newPct = newPx / mainW;
      const minPct = 200 / mainW;  // m√≠nimo 200px
      const maxPct = 0.40;         // m√°ximo 40%
      newPct = Math.max(minPct, Math.min(maxPct, newPct));
      editor.style.width = (newPct * 100).toFixed(2) + '%';
    });

    function endDrag(e){
      if(!dragging) return;
      dragging = false;
      document.body.style.userSelect = '';
      try{ splitter.releasePointerCapture(e.pointerId); }catch(_){}
    }
    window.addEventListener('pointerup', endDrag);
    window.addEventListener('pointercancel', endDrag);

    window.addEventListener("resize", ()=>{ resetPosition(); });

    init();
  </script>
</body>
</html>
